"use strict";(self.webpackChunkstryker_mutator_github_io=self.webpackChunkstryker_mutator_github_io||[]).push([[6784],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),m=u(n),d=a,k=m["".concat(s,".").concat(d)]||m[d]||p[d]||i;return n?r.createElement(k,l(l({ref:t},c),{},{components:n})):r.createElement(k,l({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var u=2;u<i;u++)l[u]=n[u];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8917:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return l},default:function(){return p},frontMatter:function(){return i},metadata:function(){return o},toc:function(){return u}});n(7294);var r=n(3905);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}const i={title:"Incremental",custom_edit_url:"https://github.com/stryker-mutator/stryker-js/edit/master/docs/incremental.md"},l=void 0,o={unversionedId:"stryker-js/incremental",id:"stryker-js/incremental",title:"Incremental",description:"StrykerJS is fast! It uses advanced techniques to speed up mutation testing, like coverage analysis, hit limit counters, and hot-reload. However, mutation testing still takes time. You might want to speed things up further for larger code bases, fast feedback, or Continuous Integration (CI) scenarios.",source:"@site/docs/stryker-js/incremental.md",sourceDirName:"stryker-js",slug:"/stryker-js/incremental",permalink:"/docs/stryker-js/incremental",draft:!1,editUrl:"https://github.com/stryker-mutator/stryker-js/edit/master/docs/incremental.md",tags:[],version:"current",frontMatter:{title:"Incremental",custom_edit_url:"https://github.com/stryker-mutator/stryker-js/edit/master/docs/incremental.md"},sidebar:"docs",previous:{title:"Disable mutants",permalink:"/docs/stryker-js/disable-mutants"},next:{title:"Plugins",permalink:"/docs/stryker-js/plugins"}},s={},u=[{value:"Incremental mode",id:"incremental-mode",level:2},{value:"Limitations",id:"limitations",level:2},{value:"Forcing reruns",id:"forcing-reruns",level:2}],c={toc:u};function p({components:e,...t}){return(0,r.kt)("wrapper",a({},c,t,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"StrykerJS is fast! It uses advanced techniques to speed up mutation testing, like coverage analysis, hit limit counters, and hot-reload. However, mutation testing still takes time. You might want to speed things up further for larger code bases, fast feedback, or Continuous Integration (CI) scenarios."),(0,r.kt)("h2",a({},{id:"incremental-mode"}),"Incremental mode"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Available since Stryker 6.2")),(0,r.kt)("p",null,"StrykerJS supports incremental mutation testing to speed things up further. When running in ",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/stryker-js/configuration#incremental-boolean"}),(0,r.kt)("inlineCode",{parentName:"a"},"--incremental"))," mode, StrykerJS will track the changes you make to your code and tests and only runs mutation testing on the changed code. But, of course, it will still provide you with the full mutation report at the end!"),(0,r.kt)("p",null,"You enable incremental mode with the ",(0,r.kt)("inlineCode",{parentName:"p"},"--incremental")," flag:"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{}),"npx stryker run --incremental\n")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Setting ",(0,r.kt)("inlineCode",{parentName:"em"},'"incremental": true')," in your stryker.conf.json file is also supported")),(0,r.kt)("p",null,'StrykerJS stores the previous result in a "reports/stryker-incremental.json" file (determined by the ',(0,r.kt)("a",a({parentName:"p"},{href:"/docs/stryker-js/configuration#incrementalfile-string"}),"--incrementalFile")," option). The next time StrykerJS runs, it will read this JSON file and try to reuse as much of it as possible. "),(0,r.kt)("p",null,"Reuse is possible when:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'A mutant was "Killed"; the culprit test still exists, and it didn\'t change.'),(0,r.kt)("li",{parentName:"ul"},'A mutant was not "Killed"; no new test covers it, and no tests changed.')),(0,r.kt)("p",null,"StrykerJS will do a git-like diff of your code and test files to the previous version it finds in the incremental report file in order to match the mutants and tests to the current version of the code."),(0,r.kt)("p",null,"You can see the statistics of the incremental analysis right after the dry run is performed. It looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{}),"        Mutants:        1 files changed (+2 -2)\n        Tests:          2 files changed (+22 -21)\n        Result:         3731 of 3965 mutant result(s).\n")),(0,r.kt)("p",null,"Here you can see that:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"One file with mutants changed (2 mutants added, 2 mutants removed)"),(0,r.kt)("li",{parentName:"ul"},"Two test files changed (22 tests added and 21 tests removed)"),(0,r.kt)("li",{parentName:"ul"},"In total, Stryker will reuse 3731 mutant results, and only 234 mutants need to run.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note"),": The dry run remains required; as it discovers tests, mutation coverage per test, and ensures Stryker runs successfully when no mutant is active."),(0,r.kt)("h2",a({},{id:"limitations"}),"Limitations"),(0,r.kt)("p",null,"Running in incremental mode, Stryker will do its best to produce an accurate mutation testing report. However, there are some limitations here:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Stryker will not detect any changes you've made in files other than mutated files and test files."),(0,r.kt)("li",{parentName:"ul"},"Detecting test file changes is only supported if the test runner plugin supports reporting the test files. (see support table below)"),(0,r.kt)("li",{parentName:"ul"},"Detecting test changes is only supported if the test runner plugin supports reporting test locations. (see support table below)"),(0,r.kt)("li",{parentName:"ul"},"Any other changes to your environment are not detected, such as updates to other files, updated (dev) dependencies, changes to environment variables, changes to ",(0,r.kt)("inlineCode",{parentName:"li"},".snap")," files, readme files, etc."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",a({parentName:"li"},{href:"../../mutation-testing-elements/static-mutants/"}),"Static mutants")," don't have test coverage; thus, Stryker won't detect test changes for them.")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Test runner plugin"),(0,r.kt)("th",a({parentName:"tr"},{align:null}),"Test reporting"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\ud83c\udccf Jest"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\u2705 Full")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\u2615 Mocha"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\u26a0 Tests per file without location")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\ud83d\udfe3 Jasmine"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\u26a0 Test names only")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\ud83d\udd35 Karma"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\u26a0 Test names only")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\ud83e\udd52 CucumberJS"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\u2705 Full")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\u25b6 Command"),(0,r.kt)("td",a({parentName:"tr"},{align:null}),"\u274c Nothing")))),(0,r.kt)("p",null,"You can use this table to understand why StrykerJS decides not to rerun a specific mutant even though you've changed tests covering that mutant."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Full"),(0,r.kt)("br",{parentName:"li"}),"Tests are reported together with their exact locations. Stryker will do a detailed diff to see which specific tests changed."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Tests per file without location"),(0,r.kt)("br",{parentName:"li"}),"Stryker knows from which files the tests originated, but not their exact locations. Therefore, Stryker assumes all tests inside a file changed when that file changed."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Test names only"),(0,r.kt)("br",{parentName:"li"}),"Stryker can't determine where the tests are located and thus cannot detect when a test changed. As a result, Stryker will only see test changes for tests that are added or removed."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Nothing"),(0,r.kt)("br",{parentName:"li"}),"All test details are unknown incremental mode will only detect changes in mutants, not their tests.")),(0,r.kt)("h2",a({},{id:"forcing-reruns"}),"Forcing reruns"),(0,r.kt)("p",null,"With these limitations in mind, you can probably imagine a scenario where you want to force specific mutants to run while using incremental mode. You can do this with ",(0,r.kt)("inlineCode",{parentName:"p"},"--force"),". If you run ",(0,r.kt)("inlineCode",{parentName:"p"},"--force"),", you tell StrykerJS to rerun all mutants in scope, regardless of the incremental file."),(0,r.kt)("p",null,"Using ",(0,r.kt)("inlineCode",{parentName:"p"},"--force")," is especially beneficial when combined with a custom ",(0,r.kt)("inlineCode",{parentName:"p"},"--mutate")," pattern. I.e., if you only want to rerun the mutants in ",(0,r.kt)("inlineCode",{parentName:"p"},"src/app.js"),", you use:"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{}),"npx stryker run --incremental --force --mutate src/app.js\n")),(0,r.kt)("p",null,"You can even specify individual lines to mutate:"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{}),"npx stryker run --incremental --force --mutate src/app.js:5-7\n")),(0,r.kt)("p",null,"In this example, you tell Stryker to only run mutation testing for lines 5 through 7 in the ",(0,r.kt)("inlineCode",{parentName:"p"},"src/app.js")," file and update the incremental report."),(0,r.kt)("p",null,"Using the combination of ",(0,r.kt)("inlineCode",{parentName:"p"},"--incremental")," with a custom ",(0,r.kt)("inlineCode",{parentName:"p"},"--mutate")," pattern, StrykerJS will not remove mutants that are not in scope and still report a full mutation report."))}p.isMDXComponent=!0}}]);